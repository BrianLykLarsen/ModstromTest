@using Archetype.Models
@using Archetype.Extensions
@using Archetype.PropertyConverters
@inherits Umbraco.Web.Mvc.UmbracoViewPage<ArchetypeFieldsetModel>

@{
	string headline = Model.GetValue<string>("headline");

	var selectComments = Model.GetValue<int[]>("selectComments").Select(x => Umbraco.TypedContent(x));
	int commentCount = selectComments.Count();
	var noSlider = "";
	if (commentCount == 2)
	{
		noSlider = "no-slider";
	}

	@*
		OBS: The logic included in this page it only to illustrate variations in design.
		The desired logic is simply that the class "no-slider" should be added if there is only one <li>  (two comments)
	*@

	<section class="section-comments @noSlider">
		<div class="container">
			<div class="row">
				<div class="col-xs-12">
					@if (commentCount == 2)
					{
						<h1>@headline</h1>
					}
					<div class="comments-container">
						<ul class="comments slides">
							@if (commentCount == 2)
							{
								<li>
									@foreach (var comment in selectComments)
									{
										string text = comment.GetPropertyValue<string>("text");
										var image = comment.GetPropertyValue<IPublishedContent>("image").Url;
										<div class="comment">
											<figure class="img-default responsiveimg-default" data-imgsrc-default="@image" data-imgalt-default="This is the alt text">
												<noscript>
													<img src="@image" alt="This is the alt text">
												</noscript>
											</figure>
											<div class="comment-text">
												@Html.Raw(text)
											</div>
										</div>
									}

								</li>
							}
							else
							{
								int counter = 0;
								foreach (var comment in selectComments)
								{
									string htmlListStart = "<li>";
									string htmlListEnd	= "</li>";

									if (counter %2==0)
									{
										@Html.Raw(htmlListStart)
									}
									
										<div class="comment">
											<figure class="img-default responsiveimg-default" data-imgsrc-default="/images/comments-placeholder.jpg" data-imgalt-default="This is the alt text">
												<noscript>
													<img src="/images/comments-placeholder.jpg" alt="This is the alt text">
												</noscript>
											</figure>
											<div class="comment-text">
												<p>
													“Jeg er vild med gratis strøm om natten. Vasker tøj, lader min telefon og min computer op om natten -
													og er i det hele taget meget bevidst om at skubbe så meget af mit forbrug til efter midnat.
													Det er en god måde at motivere folk til at bruge strøm, når den er grønnest”
												</p>
												<p class="comment-author">- Lili Ruby, Randers</p>
											</div>
										</div>
										
									if(counter != 1 && counter %2 == 1)
									{
										@Html.Raw(htmlListEnd)
									}

									counter++;
								}
							}
						</ul>
					</div>
				</div>
			</div>
		</div>
	</section>

}